<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astro Building Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Brand & UI Colors */
            --header-bg: #18181B; /* Executive Charcoal Black */
            --bg-dark: #d5dadd;
            --dashboard-bg: #ffffff;
            --box-bg: #f4f7fa;
            --border-color: #cbd5e1;
            --text-dark: #1e293b;
            --text-grey: #64748b;
            
            --blue-icon: #3b82f6;
            
            /* Dynamic Severity Colors */
            --status-green: #4ade80;
            --status-green-dark: #22c55e;
            --status-green-text: #064e3b;
            
            --red-alert: #ef4444;
            --orange-warn: #f59e0b;
            
            --bar-main: #3b82f6;
            --bar-broadcast: #64748b;
            --bar-cabin: #22c55e;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial Narrow', 'Segoe UI', Tahoma, sans-serif;
            user-select: none;
        }

        /* ========================================= */
        /* FULL SCREEN DESKTOP MODE (Dynamic vh/vw)  */
        /* ========================================= */
        body {
            background-color: var(--bg-dark);
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .dashboard-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background-color: #e2e8f0;
        }

        /* Header */
        header {
            background-color: var(--header-bg);
            color: white;
            padding: 1.2vh 2vw;
            display: flex;
            align-items: center;
            box-shadow: 0 0.5vh 1vh rgba(0,0,0,0.15);
            z-index: 10;
            height: 6.5vh;
        }
        /* Make the "A" logo pop with Astro Magenta against the charcoal black */
        .logo-a { color: #E6007D; font-size: 3.5vh; font-weight: 900; font-style: italic; margin-right: 1vw; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);}
        .header-title { font-size: 2.8vh; font-weight: bold; letter-spacing: 0.1vw; text-transform: uppercase; }
        .header-divider { margin: 0 1vw; font-weight: normal; opacity: 0.6;}

        /* Main Grid */
        .grid {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1.5vw;
            padding: 1.5vw;
            height: 93.5vh;
        }

        .column { display: flex; flex-direction: column; gap: 1.5vh; height: 100%; min-width: 0;}

        /* Card Framework - FIXED OVERFLOW */
        .card {
            background: white;
            border: 0.2vh solid var(--border-color);
            border-radius: 1vh;
            padding: 1.5vh;
            display: flex;
            flex-direction: column;
            gap: 1vh;
            flex: 1; 
            box-shadow: 0 0.4vh 1vh rgba(0,0,0,0.08);
            min-height: 0;
            overflow: hidden;
        }
        .card-inner {
            background: var(--box-bg);
            border: 0.2vh solid var(--border-color);
            border-radius: 0.8vh;
            padding: 1vh 1.5vw;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            align-items: center;
            text-align: center;
            width: 100%;
            min-height: 0;
            overflow: hidden; 
        }

        /* Split Row for BEI & CO2 */
        .split-row {
            display: flex;
            gap: 1.5vw;
            flex: 0.8;
            width: 100%;
            min-height: 0;
        }
        .split-row .card { padding: 1vh; }
        .split-row .card-inner { padding: 1vh 0.5vw; }
        
        .header-wrap { display: flex; align-items: center; gap: 0.8vw; width: 100%; justify-content: center; margin-bottom: 0.5vh;}
        .header-icon { font-size: min(2.5vh, 2vw); }
        h4 { font-size: min(1.8vh, 1.5vw); font-weight: 800; color: var(--text-grey); text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}

        /* Interactivity */
        .interactive { transition: transform 0.2s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.2s, border-color 0.2s, background-color 0.3s ease; cursor: pointer; position: relative; }
        .interactive:hover { transform: translateY(-0.3vh) scale(1.01); box-shadow: 0 1vh 2vh rgba(0,0,0,0.12); border-color: var(--blue-icon); z-index: 5;}
        .interactive:active { transform: translateY(0px) scale(0.99); box-shadow: 0 0.5vh 1vh rgba(0,0,0,0.1); }
        .hover-bg-white:hover { background-color: #ffffff; }

        /* ========================================= */
        /* WIDGET DESIGNS                            */
        /* ========================================= */

        /* 1. Status Grid */
        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 1.5vh;
            flex: 2;
            width: 100%;
            min-height: 0;
        }
        .status-box {
            border-radius: 0.8vh;
            display: flex;
            flex-direction: row; 
            align-items: center;
            justify-content: flex-start;
            padding: 1vh 1vw;
            gap: 1vw;
            box-shadow: inset 0 0 2vh rgba(255,255,255,0.3), 0 0.5vh 1vh rgba(0,0,0,0.1);
            border: 0.2vh solid transparent;
            overflow: hidden;
            transition: all 0.3s ease; 
        }
        
        .status-normal { background: var(--status-green); color: var(--status-green-text); border-color: var(--status-green-dark); }
        .status-warning { background: #fde047; color: #713f12; border-color: #eab308; }
        .status-critical { background: #fca5a5; color: #7f1d1d; border-color: #ef4444; }
        .status-cool { background: #bae6fd; color: #0c4a6e; border-color: #38bdf8; }
        
        .status-box.status-normal:hover, .energy-alert-banner.status-normal:hover { background-color: var(--status-green); border-color: var(--status-green-dark); filter: brightness(1.05); }
        .status-box.status-warning:hover, .energy-alert-banner.status-warning:hover { background-color: #fde047; border-color: #eab308; filter: brightness(1.05); }
        .status-box.status-critical:hover, .energy-alert-banner.status-critical:hover { background-color: #fca5a5; border-color: #ef4444; filter: brightness(1.05); }
        .status-box.status-cool:hover { background-color: #bae6fd; border-color: #38bdf8; filter: brightness(1.05); }

        .status-icon { font-size: min(4.5vh, 3.5vw); color: inherit; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); flex-shrink: 0;}
        .status-text-col { display: flex; flex-direction: column; align-items: flex-start; justify-content: center; min-width: 0;}
        .status-box h5 { font-size: min(1.5vh, 1.2vw); font-weight: 800; text-transform: uppercase; opacity: 0.9; margin-bottom: 0.2vh; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; text-align: left;}
        .status-box h2 { font-size: min(3vh, 2.5vw); font-weight: 900; line-height: 1; margin-bottom: 0.2vh; letter-spacing: 0.05vw; }
        .status-box span { font-size: min(1.4vh, 1.1vw); font-weight: bold; text-transform: uppercase;}

        /* Meeting Rooms */
        .meeting-wrap { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 0.8vh; width: 100%; flex: 1; min-height: 0;}
        .meeting-pills { display: flex; flex-wrap: wrap; gap: 0.8vh; justify-content: center; }
        .pill { background: white; padding: 0.4vh 0.8vw; border-radius: 0.5vh; border: 0.2vh solid var(--border-color); font-size: min(1.6vh, 1.2vw); font-weight: bold; color: var(--text-dark); box-shadow: 0 0.2vh 0.5vh rgba(0,0,0,0.05); display: flex; align-items: center; gap: 0.4vw; white-space: nowrap;}
        .pill i { font-size: 1.3vh; color: var(--blue-icon); opacity: 0.7;}

        /* 2. Energy Column */
        .energy-wrap { display: flex; flex-direction: row; align-items: center; justify-content: center; gap: 1.5vw; width: 100%; flex: 1; min-height: 0;}
        .energy-main-icon { font-size: min(6vh, 5vw); color: var(--orange-warn); filter: drop-shadow(0 4px 6px rgba(245, 158, 11, 0.4)); flex-shrink: 0;}
        .energy-text { display: flex; flex-direction: column; align-items: flex-start; justify-content: center;}
        .energy-text h1 { font-size: min(5.5vh, 4vw); font-weight: 900; color: var(--text-dark); line-height: 1; letter-spacing: -0.1vw; margin: 0; white-space: nowrap;}
        .energy-text p { font-size: min(1.8vh, 1.5vw); font-weight: bold; color: var(--text-grey); margin-top: 0.5vh; text-transform: uppercase; white-space: nowrap;}

        .energy-alert-banner { width: 100%; padding: 1.5vh; display: flex; align-items: center; justify-content: center; gap: 1vw; margin-top: auto; border-top: 0.2vh solid rgba(0,0,0,0.1); }
        .energy-alert-banner i { font-size: min(3.5vh, 3vw); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
        .energy-alert-banner h3 { font-size: min(2.5vh, 2vw); font-weight: 900; letter-spacing: 0.1vw; margin: 0; }

        .mini-stat { display: flex; align-items: center; justify-content: center; width: 100%; font-size: min(2.5vh, 2vw); color: var(--text-grey); font-weight: 600;}
        .mini-stat i { font-size: min(4vh, 3.5vw); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); flex-shrink: 0;}
        .mini-stat strong { font-weight: 900; color: var(--text-dark); font-size: min(3.2vh, 2.8vw); margin-left: 0.5vw;}

        /* NEW BADGE STYLES FOR SOLAR & TREES */
        .icon-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            width: min(8vh, 6vw);
            height: min(8vh, 6vw);
            border-radius: 50%;
            flex-shrink: 0;
            box-shadow: 0 0.5vh 1vh rgba(0,0,0,0.15);
        }
        .icon-badge i {
            font-size: min(4vh, 3vw) !important;
            filter: none !important;
            color: white;
        }
        .solar-badge { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .tree-badge { background: linear-gradient(135deg, #4ade80, #16a34a); }


        /* -- EDUCATIONAL ELEMENTS -- */
        .carousel-container { position: relative; height: 2.5vh; width: 100%; display: flex; justify-content: center; align-items: center; overflow: hidden; margin-top: 1.5vh; }
        .carousel-item { position: absolute; opacity: 0; transition: opacity 0.8s ease-in-out; font-size: min(1.4vh, 1.2vw); font-weight: 800; color: var(--text-dark); width: 100%; text-align: center; }
        .carousel-item.active { opacity: 1; z-index: 2;}

        .flip-container { perspective: 1000px; flex: 1; padding: 0; border: none; box-shadow: none; background: transparent; cursor: pointer; min-height: 0;}
        .flipper { transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1); transform-style: preserve-3d; position: relative; width: 100%; height: 100%; }
        .flipper.flipped { transform: rotateY(180deg); }
        .front, .back { backface-visibility: hidden; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 1vh; box-shadow: 0 0.4vh 1vh rgba(0,0,0,0.08); border: 0.2vh solid var(--border-color); background: var(--box-bg); display: flex; flex-direction: column; justify-content: center; align-items: center;}
        .front:hover { background-color: #ffffff; border-color: var(--status-green-dark);}
        
        .back { transform: rotateY(180deg); background: var(--status-green-dark); color: white; border-color: var(--status-green-dark); padding: 1vh 2vw; text-align: center; }
        .info-icon { position: absolute; top: 1vh; right: 1vw; font-size: min(1.8vh, 1.5vw); color: var(--text-grey); opacity: 0.6; }
        .back .info-icon { color: white; opacity: 0.9;}

        /* 3. Area Usage Column */
        .area-chart { display: flex; flex-direction: column; justify-content: space-between; gap: 1vh; width: 100%; flex: 1; padding: 0.5vh 0; min-height: 0;}
        .chart-group { display: flex; align-items: stretch; width: 100%; flex: 1; min-height: 0;}
        .group-name { width: 25%; text-align: right; padding-right: 1vw; font-size: min(1.6vh, 1.4vw); font-weight: 800; color: var(--text-dark); display: flex; align-items: center; justify-content: flex-end; line-height: 1.1;}
        .bar-container { flex: 1; border-left: 0.3vh solid #94a3b8; padding-left: 1vw; display: flex; flex-direction: column; justify-content: center; gap: 0.6vh; min-height: 0;}
        .bar-row { display: flex; align-items: center; width: 100%; flex: 1; cursor: pointer; min-height: 0;}
        .bar-label { width: 22%; font-size: min(1.4vh, 1.2vw); font-weight: bold; color: var(--text-dark); text-align: left; white-space: nowrap;}
        .bar-track { flex: 1; height: 1.2vh; display: flex; align-items: center; background: #e2e8f0; border-radius: 1vh; overflow: hidden; margin-left: 0.5vw;}
        .bar-fill { height: 100%; transition: width 0.8s cubic-bezier(0.22, 1, 0.36, 1); border-radius: 0 1vh 1vh 0;}
        
        .bg-main { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .bg-broad { background: linear-gradient(90deg, #64748b, #94a3b8); }
        .bg-cabin { background: linear-gradient(90deg, #22c55e, #4ade80); }

        /* BEI & CO2 Styles */
        .large-metric-icon { font-size: min(6vh, 4.5vw); margin-bottom: 0.5vh; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15)); }
        .large-metric-val { font-size: min(4.5vh, 3.5vw); font-weight: 900; color: var(--text-dark); line-height: 1; letter-spacing: -0.1vw; margin: 0;}
        .large-metric-unit { font-size: 0.4em; vertical-align: baseline; font-weight: 800; color: var(--text-grey);}
        .large-metric-desc { font-size: min(1.2vh, 1vw); font-weight: 900; margin-top: 0.5vh; text-transform: uppercase; letter-spacing: 0.05vw;}

        /* Toasts */
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        
        #toast { position: fixed; bottom: -10vh; left: 50%; transform: translateX(-50%); background: rgba(15, 23, 42, 0.95); color: white; padding: 1.5vh 3vw; border-radius: 5vh; font-size: 2.2vh; font-weight: bold; transition: bottom 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 1000; box-shadow: 0 1vh 2vh rgba(0,0,0,0.3); pointer-events: none; }
        #toast.show { bottom: 4vh; }


        /* ========================================= */
        /* MOBILE RESPONSIVENESS (PERFECT FIT & FILL)*/
        /* ========================================= */
        @media (max-width: 1024px) {
            body { height: auto; overflow-y: auto; overflow-x: hidden; display: block; }
            .dashboard-container { height: auto; display: block; }
            
            header { height: auto; padding: 15px 10px; flex-direction: column; justify-content: center; text-align: center; gap: 10px; }
            .logo-a { font-size: 30px; margin: 0; }
            .header-title { font-size: 18px; letter-spacing: normal; line-height: 1.3;}
            .header-divider { display: none; }
            
            .grid { grid-template-columns: 1fr; height: auto; display: flex; flex-direction: column; gap: 15px; padding: 10px; }
            .column { height: auto; gap: 15px; }
            
            .card { padding: 10px; border-radius: 10px; border-width: 2px; height: auto; overflow: visible;}
            .card-inner { padding: 15px; border-radius: 8px; gap: 15px; border-width: 2px; width: 100%; justify-content: center; height: auto; overflow: visible;}
            
            .header-wrap { justify-content: center; margin-bottom: 5px; gap: 10px;}
            .header-icon { font-size: 20px; }
            h4 { font-size: 16px; margin-bottom: 0; text-align: center; width: auto; white-space: normal;}
            
            /* Status Grid Mobile */
            .status-grid { gap: 10px; height: auto;}
            .status-box { padding: 15px 10px; border-width: 2px; gap: 10px; flex-direction: column; text-align: center; justify-content: center;}
            .status-icon { font-size: 36px; }
            .status-text-col { align-items: center; width: 100%;}
            .status-box h5 { font-size: 13px; margin-bottom: 5px; text-align: center; white-space: normal;}
            .status-box h2 { font-size: 24px; margin-bottom: 5px;}
            .status-box span { font-size: 12px; }
            
            /* Meeting Rooms */
            .meeting-wrap { height: auto; gap: 10px;}
            .meeting-pills { gap: 8px; }
            .pill { font-size: 15px; padding: 10px 14px; border-width: 2px; gap: 8px;}
            .pill i { font-size: 14px; }

            /* Energy Column Mobile Fixes */
            .energy-wrap { flex-direction: column; gap: 15px; text-align: center; padding: 10px 0;}
            .energy-main-icon { font-size: 50px; }
            .energy-text { align-items: center; }
            .energy-text h1 { font-size: 45px; white-space: normal;}
            .energy-text p { font-size: 16px; margin-top: 5px; white-space: normal;}
            
            .energy-alert-banner { padding: 15px 10px; gap: 10px; border-top-width: 2px;}
            .energy-alert-banner i { font-size: 28px; }
            .energy-alert-banner h3 { font-size: 20px; }

            /* Badges Mobile Spacing */
            .mini-stat { font-size: 18px; flex-direction: row; justify-content: center; gap: 20px; width: 100%;}
            .icon-badge { width: 70px; height: 70px; }
            .icon-badge i { font-size: 35px !important; }
            .mini-stat strong { font-size: 28px; margin-left: 5px;}

            /* Mobile Overrides for Educational UX */
            .carousel-container { height: 30px; margin-top: 15px; }
            .carousel-item { font-size: 14px; }
            .flip-container { min-height: 120px; }
            .front, .back { border-radius: 8px; border-width: 2px; padding: 15px;}
            .info-icon { font-size: 18px; top: 10px; right: 15px; }
            .back h4 { font-size: 16px; color: white;}
            .back p { font-size: 14px; font-weight: normal;}
            
            /* Area Chart Mobile Fixes */
            .area-chart { gap: 15px; height: auto;}
            .chart-group { flex-direction: column; flex: none; height: auto; gap: 5px; background: white; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); }
            .group-name { width: 100%; text-align: left; font-size: 16px; justify-content: flex-start; border-bottom: 1px solid #eee; padding-bottom: 5px; }
            .bar-container { border-left: none; padding-left: 0; gap: 8px; margin-top: 5px;}
            .bar-row { height: auto; min-height: 25px; }
            .bar-label { width: 85px; font-size: 14px; white-space: normal;}
            .bar-track { height: 14px; }

            /* Split Row Mobile (BEI & CO2) */
            .split-row { flex-direction: column; gap: 15px; }
            .split-row .card { padding: 10px; }
            .split-row .card-inner { padding: 15px; }
            .large-metric-icon { font-size: 45px; margin-bottom: 10px;}
            .large-metric-val { font-size: 38px; }
            .large-metric-desc { font-size: 15px; margin-top: 10px;}

            #toast { font-size: 15px; padding: 15px; width: 90%; text-align: center; border-radius: 10px; bottom: -100px; }
            #toast.show { bottom: 20px; }
        }
    </style>
</head>
<body>

    <div class="dashboard-container">
        
        <header>
            <div class="logo-a">A</div>
            <div class="header-title">ASTRO OFFICE BUILDING <span class="header-divider">|</span> BUILDING MANAGEMENT SYSTEM</div>
        </header>

        <div class="grid">
            
            <div class="column">
                <div class="card" style="background: transparent; border: none; box-shadow: none; padding: 0;">
                    <div class="status-grid">
                        
                        <div class="status-box status-normal interactive" onclick="refreshComfort(this)">
                            <i class="fa-solid fa-gauge-high status-icon"></i>
                            <div class="status-text-col">
                                <h5>Space Comfort Index</h5>
                                <h2 id="comfort-text">COMFORT</h2>
                                <span>INDEX: <strong id="comfort-idx">2.63</strong></span>
                            </div>
                        </div>

                        <div class="status-box status-normal interactive" data-state="normal" onclick="cycleSeverity(this, 'water')">
                            <i class="fa-solid fa-droplet status-icon"></i>
                            <div class="status-text-col">
                                <h5>Water Disturbance</h5>
                                <h2>NORMAL</h2>
                                <span>SYSTEM STABLE</span>
                            </div>
                        </div>

                        <div class="status-box status-normal interactive" data-state="normal" onclick="cycleSeverity(this, 'elevator')">
                            <i class="fa-solid fa-elevator status-icon"></i>
                            <div class="status-text-col">
                                <h5>Elevator Status</h5>
                                <h2>NORMAL</h2>
                                <span>ALL CABINS ACTIVE</span>
                            </div>
                        </div>

                        <div class="status-box status-normal interactive" data-state="normal" onclick="cycleSeverity(this, 'sprinkler')">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="status-icon" style="width: 1em; height: 1em;">
                                <path d="M4 2h16v3H4z" />
                                <path d="M10 5h4v4l-1 2h-2l-1-2z" />
                                <circle cx="12" cy="11.5" r="1.5" />
                                <g stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-dasharray="0 5" fill="none">
                                    <path d="M12 14v8" />
                                    <path d="M9 13.5l-5 7" />
                                    <path d="M15 13.5l5 7" />
                                </g>
                            </svg>
                            <div class="status-text-col">
                                <h5>Sprinkler Status</h5>
                                <h2>NORMAL</h2>
                                <span>PRESSURE OPTIMAL</span>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="card card-inner hover-bg-white interactive" onclick="showToast('Accessing room booking schedules...', '#3b82f6')">
                    <div class="header-wrap">
                        <i class="fa-solid fa-people-roof header-icon" style="color: var(--blue-icon);"></i>
                        <h4>AVAILABLE MEETING ROOMS</h4>
                    </div>
                    <div class="meeting-wrap">
                        <div class="meeting-pills">
                            <div class="pill"><i class="fa-solid fa-door-open"></i> CMS 1</div>
                            <div class="pill"><i class="fa-solid fa-door-open"></i> CMS 3</div>
                            <div class="pill"><i class="fa-solid fa-door-open"></i> CMS 5</div>
                            <div class="pill"><i class="fa-solid fa-door-open"></i> CMS 7</div>
                            <div class="pill"><i class="fa-solid fa-door-open"></i> CMS 9</div>
                        </div>
                        <div class="meeting-pills">
                            <div class="pill"><i class="fa-solid fa-building"></i> Level3 Room1</div>
                            <div class="pill"><i class="fa-solid fa-building"></i> Level3 Room2</div>
                        </div>
                        <div class="meeting-pills">
                            <div class="pill"><i class="fa-solid fa-building"></i> Level3 Room3</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="column">
                
                <div class="card card-inner" style="padding: 0; flex: 2.2; overflow: hidden; justify-content: space-between;">
                    <div style="padding: 1.5vh 1.5vw; display: flex; flex-direction: column; height: 100%; width: 100%;">
                        <div class="header-wrap" style="margin-bottom: auto;">
                            <i class="fa-solid fa-chart-line header-icon" style="color: var(--text-grey);"></i>
                            <h4>ENERGY & SUSTAINABILITY TODAY</h4>
                        </div>
                        
                        <div class="energy-wrap interactive" onclick="refreshEnergy()" style="margin: auto 0;">
                            <i class="fa-solid fa-bolt-lightning energy-main-icon"></i>
                            <div class="energy-text">
                                <h1 id="energy-val">22,590 <span style="font-size: 0.6em; vertical-align: middle;">kWh</span></h1>
                                <p>Total energy used today</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="energy-alert-banner status-warning interactive" id="energy-alert-box" data-state="warning" onclick="cycleEnergySeverity(this)">
                        <i class="fa-solid fa-triangle-exclamation" id="energy-alert-icon" style="animation: pulse 1.5s infinite;"></i>
                        <h3 id="energy-alert-text">HIGHER THAN USUAL</h3>
                    </div>
                </div>

                <div class="card card-inner hover-bg-white interactive" style="justify-content: center; padding-top: 2vh; padding-bottom: 2vh;" onclick="showToast('Connecting to Solar Inverter...', 'var(--blue-icon)')">
                    <div class="mini-stat">
                        <div class="icon-badge solar-badge">
                            <i class="fa-solid fa-solar-panel"></i>
                        </div>
                        <span>SOLAR POWERING : <strong>8%</strong></span>
                    </div>
                    <div class="carousel-container">
                        <div class="carousel-item active"><i class="fa-solid fa-plug" style="color: #f59e0b;"></i> Equivalent to powering 100% of all office monitors.</div>
                        <div class="carousel-item"><i class="fa-solid fa-bullseye" style="color: var(--blue-icon);"></i> Target: 15% solar reliance by 2027.</div>
                        <div class="carousel-item"><i class="fa-solid fa-elevator" style="color: var(--text-grey);"></i> Enough energy to run all elevators for 12 hours.</div>
                    </div>
                </div>

                <div class="card flip-container interactive" onclick="toggleFlip(this)">
                    <div class="flipper">
                        <div class="front hover-bg-white">
                            <i class="fa-solid fa-circle-info info-icon"></i>
                            <div class="mini-stat">
                                <div class="icon-badge tree-badge">
                                    <i class="fa-solid fa-tree"></i>
                                </div>
                                <span>TREES SAVED : <strong id="trees-val">280</strong></span>
                            </div>
                        </div>
                        <div class="back">
                            <i class="fa-solid fa-rotate-left info-icon" style="color: rgba(255,255,255,0.8);"></i>
                            <h4 style="color: white; margin-bottom: 1vh;">DID YOU KNOW?</h4>
                            <p style="font-size: min(1.6vh, 1.3vw); font-weight: 600; line-height: 1.4;">
                                This equals a forest the size of 3 football fields! These trees filter enough oxygen for <strong>1,120 people</strong> to breathe today.
                            </p>
                        </div>
                    </div>
                </div>

            </div>

            <div class="column">
                
                <div class="card card-inner hover-bg-white interactive" style="flex: 1.6;" onclick="randomizeBars()">
                    <div class="header-wrap">
                        <i class="fa-solid fa-chart-simple header-icon" style="color: var(--text-grey);"></i>
                        <h4>ENERGY USAGE BY AREA</h4>
                    </div>
                    <div class="area-chart">
                        <div class="chart-group">
                            <div class="group-name">Main<br>Building</div>
                            <div class="bar-container">
                                <div class="bar-row"><div class="bar-label">Ground</div><div class="bar-track"><div class="bar-fill bg-main" id="bar1" style="width: 100%;"></div></div></div>
                                <div class="bar-row"><div class="bar-label">1st</div><div class="bar-track"><div class="bar-fill bg-main" id="bar2" style="width: 65%;"></div></div></div>
                                <div class="bar-row"><div class="bar-label">2nd</div><div class="bar-track"><div class="bar-fill bg-main" id="bar3" style="width: 85%;"></div></div></div>
                                <div class="bar-row"><div class="bar-label">3rd Floor</div><div class="bar-track"><div class="bar-fill bg-main" id="bar4" style="width: 75%;"></div></div></div>
                            </div>
                        </div>
                        <div class="chart-group" style="flex: 0.3;">
                            <div class="group-name">Broadcast<br>Building</div>
                            <div class="bar-container">
                                <div class="bar-row"><div class="bar-track"><div class="bar-fill bg-broad" id="bar5" style="width: 70%;"></div></div></div>
                            </div>
                        </div>
                        <div class="chart-group">
                            <div class="group-name">Cabin 3</div>
                            <div class="bar-container">
                                <div class="bar-row"><div class="bar-label">Level 1</div><div class="bar-track"><div class="bar-fill bg-cabin" id="bar6" style="width: 45%;"></div></div></div>
                                <div class="bar-row"><div class="bar-label">Level 2</div><div class="bar-track"><div class="bar-fill bg-cabin" id="bar7" style="width: 60%;"></div></div></div>
                                <div class="bar-row"><div class="bar-label">Level 3</div><div class="bar-track"><div class="bar-fill bg-cabin" id="bar8" style="width: 45%;"></div></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="split-row">
                    <div class="card card-inner hover-bg-white interactive" onclick="refreshBEI()">
                        <div class="header-wrap">
                            <h4 style="font-size: min(1.5vh, 1.2vw);">BEI</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1;">
                            <i class="fa-solid fa-leaf large-metric-icon" style="color: var(--status-green-dark);"></i>
                            <h1 class="large-metric-val" id="bei-val">115 <span class="large-metric-unit">kWh/m²</span></h1>
                            <p class="large-metric-desc" id="bei-desc" style="color: var(--status-green-dark);">EXCELLENT</p>
                        </div>
                    </div>

                    <div class="card card-inner hover-bg-white interactive" onclick="refreshCO2()">
                        <div class="header-wrap">
                            <h4 style="font-size: min(1.5vh, 1.2vw);">CO2 AVOIDED</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1;">
                            <i class="fa-solid fa-smog large-metric-icon" style="color: #64748b;"></i>
                            <h1 class="large-metric-val" id="co2-val">4.25 <span class="large-metric-unit">tons/month</span></h1>
                            <p class="large-metric-desc" style="color: var(--text-grey);">OFFSET</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="toast">Data Refreshed!</div>

    <script>
        // --- 1. Basic Interactive Functions ---
        let toastTimeout;
        function showToast(message, color = '#1e293b') {
            const toast = document.getElementById('toast');
            toast.innerText = message;
            toast.style.backgroundColor = color;
            toast.classList.add('show');
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        function getRnd(min, max) { return Math.floor(Math.random() * (max - min + 1) ) + min; }

        // --- 2. Educational Feature Scripts ---
        
        // Carousel Auto-Rotator
        let currentCarouselIdx = 0;
        const carouselItems = document.querySelectorAll('.carousel-item');
        setInterval(() => {
            if(carouselItems.length > 0) {
                carouselItems[currentCarouselIdx].classList.remove('active');
                currentCarouselIdx = (currentCarouselIdx + 1) % carouselItems.length;
                carouselItems[currentCarouselIdx].classList.add('active');
            }
        }, 4000); 

        // Flip Card Logic (Auto + Manual)
        let flipInterval;
        
        function toggleFlip(element) {
            const flipper = element.querySelector('.flipper');
            if(flipper) flipper.classList.toggle('flipped');
            
            clearInterval(flipInterval);
            startAutoFlip();
        }

        function startAutoFlip() {
            flipInterval = setInterval(() => {
                const flipper = document.querySelector('.flip-container .flipper');
                if(flipper) flipper.classList.toggle('flipped');
            }, 10000); 
        }

        startAutoFlip();

        // --- 3. Demo Data Scripts ---

        function refreshComfort(element) {
            let idx = (Math.random() * (2.9 - 2.1) + 2.1).toFixed(2);
            document.getElementById('comfort-idx').innerText = idx;
            let statusText = document.getElementById('comfort-text');
            
            element.classList.remove('status-normal', 'status-warning', 'status-cool');

            if(idx > 2.8) { 
                statusText.innerText = "WARM"; 
                element.classList.add('status-warning');
                showToast('Temperature rising. HVAC adjusting...', '#ca8a04');
            }
            else if(idx < 2.2) { 
                statusText.innerText = "COOL"; 
                element.classList.add('status-cool');
                showToast('Temperature dropping. Heating engaged.', '#0284c7');
            }
            else { 
                statusText.innerText = "COMFORT"; 
                element.classList.add('status-normal');
                showToast('Comfort Index Sensors Recalculated', '#064e3b');
            }
        }

        function cycleSeverity(element, system) {
            let currentState = element.getAttribute('data-state') || 'normal';
            let titleEl = element.querySelector('h2');
            let subEl = element.querySelector('span');

            element.classList.remove('status-normal', 'status-warning', 'status-critical');

            if (currentState === 'normal') {
                element.setAttribute('data-state', 'warning');
                element.classList.add('status-warning');
                titleEl.innerText = 'WARNING';
                if(system === 'water') subEl.innerText = 'MINOR LEAK DETECTED';
                if(system === 'elevator') subEl.innerText = 'CABIN 1 OFFLINE';
                if(system === 'sprinkler') subEl.innerText = 'PRESSURE FLUCTUATING';
                showToast(system.toUpperCase() + ' warning triggered for demo.', '#ca8a04');
            } 
            else if (currentState === 'warning') {
                element.setAttribute('data-state', 'critical');
                element.classList.add('status-critical');
                titleEl.innerText = 'CRITICAL';
                if(system === 'water') subEl.innerText = 'MAIN PIPE BURST';
                if(system === 'elevator') subEl.innerText = 'SYSTEM FAILURE';
                if(system === 'sprinkler') subEl.innerText = 'SYSTEM OFFLINE';
                showToast(system.toUpperCase() + ' critical alert triggered!', '#dc2626');
            } 
            else {
                element.setAttribute('data-state', 'normal');
                element.classList.add('status-normal');
                titleEl.innerText = 'NORMAL';
                if(system === 'water') subEl.innerText = 'SYSTEM STABLE';
                if(system === 'elevator') subEl.innerText = 'ALL CABINS ACTIVE';
                if(system === 'sprinkler') subEl.innerText = 'PRESSURE OPTIMAL';
                showToast(system.toUpperCase() + ' system normalized.', '#16a34a');
            }
        }

        function cycleEnergySeverity(element) {
            let currentState = element.getAttribute('data-state') || 'warning';
            let titleEl = document.getElementById('energy-alert-text');
            let iconEl = document.getElementById('energy-alert-icon');

            element.classList.remove('status-normal', 'status-warning', 'status-critical');
            iconEl.classList.remove('fa-circle-check', 'fa-triangle-exclamation', 'fa-bolt');
            iconEl.style.animation = 'none';

            if (currentState === 'warning') {
                element.setAttribute('data-state', 'critical');
                element.classList.add('status-critical');
                titleEl.innerText = 'CRITICAL SURGE DETECTED';
                iconEl.classList.add('fa-bolt');
                iconEl.style.animation = 'pulse 1s infinite';
                showToast('CRITICAL: Power surge detected. Initiating load shedding.', '#dc2626');
            } 
            else if (currentState === 'critical') {
                element.setAttribute('data-state', 'normal');
                element.classList.add('status-normal');
                titleEl.innerText = 'USAGE NORMAL';
                iconEl.classList.add('fa-circle-check');
                showToast('Energy usage has returned to normal levels.', '#16a34a');
            } 
            else {
                element.setAttribute('data-state', 'warning');
                element.classList.add('status-warning');
                titleEl.innerText = 'HIGHER THAN USUAL';
                iconEl.classList.add('fa-triangle-exclamation');
                iconEl.style.animation = 'pulse 1.5s infinite';
                showToast('WARNING: Energy usage spiking.', '#ca8a04');
            }
        }

        function refreshEnergy() {
            let currentStr = document.getElementById('energy-val').innerText.replace(/\D/g,'');
            let current = parseInt(currentStr);
            let newVal = current + getRnd(5, 20);
            
            document.getElementById('energy-val').innerHTML = newVal.toLocaleString() + ' <span class="large-metric-unit" style="font-size: 0.6em;">kWh</span>';
            showToast('Energy Consumption Meter Read', 'var(--orange-warn)');
        }

        function refreshBEI() {
            let currentStr = document.getElementById('bei-val').innerText.replace(/\D/g,'');
            let current = parseInt(currentStr);
            
            let newVal = current + getRnd(-3, 3);
            if(newVal < 90) newVal = 90;
            if(newVal > 150) newVal = 150;

            document.getElementById('bei-val').innerHTML = newVal + ' <span class="large-metric-unit">kWh/m²</span>';
            
            let desc = document.getElementById('bei-desc');
            let icon = document.querySelector('#bei-val').previousElementSibling;

            if(newVal <= 120) {
                desc.innerText = "EXCELLENT";
                desc.style.color = "var(--status-green-dark)";
                icon.style.color = "var(--status-green-dark)";
            } else if (newVal <= 135) {
                desc.innerText = "GOOD EFFICIENCY";
                desc.style.color = "#84cc16"; 
                icon.style.color = "#84cc16";
            } else {
                desc.innerText = "NEEDS REVIEW";
                desc.style.color = "var(--orange-warn)";
                icon.style.color = "var(--orange-warn)";
            }
            
            showToast('Building Energy Index Recalculated', 'var(--blue-icon)');
        }

        function refreshCO2() {
            let currentStr = document.getElementById('co2-val').innerText.replace(/[^\d.-]/g, '');
            let current = parseFloat(currentStr);
            let newVal = current + (getRnd(1, 5) / 100);
            
            document.getElementById('co2-val').innerHTML = newVal.toFixed(2) + ' <span class="large-metric-unit">tons/month</span>';
            showToast('Emission offset metrics updated.', '#64748b');
        }

        function randomizeBars() {
            for(let i=1; i<=8; i++) {
                document.getElementById('bar'+i).style.width = getRnd(30, 100) + '%';
            }
            showToast('Area Energy Distribution Recalculated', '#64748b');
        }
    </script>
</body>
</html>
